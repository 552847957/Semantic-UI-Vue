<template>
  <sui-grid :columns="1" padded>
    <sui-grid-column>
      <h1 is="sui-header">
        {{ title }}
        <sui-header-subheader>
          {{ component.description }}
        </sui-header-subheader>
      </h1>

      <sui-list class="space" horizontal link size="small">
        <sui-list-item>
          <sui-header color="grey" size="tiny"  />
        </sui-list-item>
      </sui-list>

      <sui-list class="docs-info" link>
        <sui-list-item>
          <sui-list-icon name="github" />
          <sui-list-content>
            <code>
              <a href="#">src/{{this.type}}/{{title}}/{{title}}.js</a>
            </code>
          </sui-list-content>
        </sui-list-item>
        <sui-list-item>
          <sui-list-icon name="book" />
          <sui-list-content>
            <a href="#">Semantic UI {{title}} Docs</a>
          </sui-list-content>
        </sui-list-item>
      </sui-list>

      <h4 class="props-switcher" is="sui-header" :color="propSwitcherColor">
        <a href="javascript:void 0" @click="toggleProps">
          <sui-icon :name="propSwitcherIcon" />
          Props:
        </a>
      </h4>

      <sui-menu color="green" compact secondary size="small">
        <sui-menu-item
          :active="currentComponent === component"
          link
          @click.native="currentComponent = component"
        >
          {{ component.name }}
        </sui-menu-item>
        <sui-menu-item
          v-for="subcomponent in subcomponents"
          :key="subcomponent.name"
          :active="currentComponent === subcomponent"
          link
          @click.native="currentComponent = subcomponent"
        >
          {{ subcomponent.name }}
        </sui-menu-item>
      </sui-menu>

      <div v-if="currentComponent">
        <div class="current-component-description">
          {{ currentComponent.description }}
        </div>

        <sui-divider />
      </div>
    </sui-grid-column>
  </sui-grid>
</template>

<script>
import capitalize from 'lodash/capitalize';
import get from 'lodash/get';
import * as components from 'src';

const getComponentFromName = name => components[capitalize(name)];

export default {
  name: 'Component',
  data() {
    return {
      currentComponent: getComponentFromName(this.componentName),
    };
  },
  computed: {
    title() {
      return capitalize(this.componentName);
    },
    component() {
      return getComponentFromName(this.componentName);
    },
    propSwitcherColor() {
      return this.currentComponent ? 'green' : 'grey';
    },
    propSwitcherIcon() {
      return `toggle ${this.currentComponent ? 'on' : 'off'}`;
    },
    subcomponents() {
      return Object
        .values(components)
        .filter(c => get(c, 'meta.parent') === this.component.name);
    },
  },
  methods: {
    toggleProps() {
      if (this.currentComponent) {
        this.currentComponent = null;
      } else {
        this.currentComponent = this.component;
      }
    },
  },
  watch: {
    componentName(v) {
      this.currentComponent = getComponentFromName(v);
    },
  },
  props: {
    type: String,
    componentName: String,
  },
};
</script>

<style scoped>
.space {
  display: block!important;
}

.docs-info {
  position: absolute!important;
  padding: 0.5em!important;
  margin: 0.5em!important;
  top: 0px!important;
  right: 0px!important;
  box-shadow: rgb(247, 247, 247) 0px 0px 1em 0.5em!important;
  background: rgb(247, 247, 247)!important;
}

.props-switcher {
  display: inline-flex!important;
  margin: 1em 0.5em 1em 0px!important;
  cursor: pointer!important;
}

.props-switcher>a {
  color: inherit;
}

.current-component-description {
  font-size: 1.08em;
  color: rgb(119, 119, 119);
}

code {
  padding: 0;
  padding-top: 0.1em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 87.5%;
  background-color: rgba(0, 0, 0, 0.04);
  border-radius: 3px;
}

code:after,
code:before {
  letter-spacing: -0.2em;
  content: "\00a0";
}
</style>
